{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags static %}

{% block title %}DPW ABI Sumatera Selatan - Beranda{% endblock %}

{% block content %}
<!-- ======= Hero Section ======= -->
<section id="hero" class="hero">
    <div class="container position-relative">
        <div class="row gy-5">
            
            <!-- Countdown Section -->
            {% if countdown and countdown.is_active %}
            <div id="contDown" class="col-lg-2 order-1 order-lg-1">
                <div class="row">
                    <div class="col-12 text-center" style="font-size: 14px;">
                        <b>{{ countdown.title }}</b>
                    </div>
                    {% if countdown.description %}
                    <div class="col-12 text-center" style="font-size: 12px;">
                        {{ countdown.description }}
                    </div>
                    {% endif %}
                    <div class="col-12">
                        <div id="countdown-timer" 
                             data-end-date="{{ countdown.end_date|date:'c' }}"
                             class="text-center mt-2"></div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Rest of your hero content -->
            <div class="col-lg-{% if countdown %}4{% else %}6{% endif %} order-3 order-lg-2 d-flex flex-column justify-content-center text-center text-lg-start">
                <h2>DPW <span>ABI SUMSEL</span></h2>
                <p>{{ page.hero_subtitle|default:"Sinergi khidmad untuk bangsa yang bermartabat" }}</p>
                <div class="d-flex justify-content-center justify-content-lg-start">
                    {% if page.hero_button_link %}
                    <a href="{{ page.hero_button_link.url }}" class="btn-get-started">
                        {{ page.hero_button_text|default:"Get Started" }}
                    </a>
                    {% endif %}
                </div>
            </div>

            <div class="col-lg-6 order-2 order-lg-3">
                {% if page.hero_image %}
                    {% image page.hero_image fill-600x400 class="img-fluid" alt="ABI SUMSEL" %}
                {% else %}
                    <img src="{% static 'img/logoabi.png' %}" class="img-fluid" alt="ABI SUMSEL">
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Icon boxes section... -->
</section>
{% endblock %}

{% block extra_js %}
{% if countdown and countdown.is_active %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const countdownElement = document.getElementById('countdown-timer');
    const endDate = new Date(countdownElement.dataset.endDate).getTime();
    
    function updateCountdown() {
        const now = new Date().getTime();
        const distance = endDate - now;
        
        if (distance < 0) {
            countdownElement.innerHTML = "Event telah dimulai!";
            return;
        }
        
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        
        countdownElement.innerHTML = `
            <div class="row">
                <div class="col-3">
                    <div style="font-size: 20px; font-weight: bold;">${days}</div>
                    <div style="font-size: 10px;">Hari</div>
                </div>
                <div class="col-3">
                    <div style="font-size: 20px; font-weight: bold;">${hours}</div>
                    <div style="font-size: 10px;">Jam</div>
                </div>
                <div class="col-3">
                    <div style="font-size: 20px; font-weight: bold;">${minutes}</div>
                    <div style="font-size: 10px;">Menit</div>
                </div>
                <div class="col-3">
                    <div style="font-size: 20px; font-weight: bold;">${seconds}</div>
                    <div style="font-size: 10px;">Detik</div>
                </div>
            </div>
        `;
    }
    
    updateCountdown();
    setInterval(updateCountdown, 1000);
});
</script>
{% endif %}
{% endblock %}